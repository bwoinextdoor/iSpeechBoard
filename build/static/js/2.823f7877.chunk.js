(this.webpackJsonpcboard=this.webpackJsonpcboard||[]).push([[2],{1906:function(e,t,r){"use strict";r.r(t),r.d(t,"IMPORT_CONFIG_BY_EXTENSION",(function(){return o})),r.d(t,"IMPORT_PATHS",(function(){return i})),r.d(t,"CBOARD_EXT_PREFIX",(function(){return u})),r.d(t,"CBOARD_EXT_PROPERTIES",(function(){return c}));var n=r(1907),a=r(459),o={json:n.cboardImportAdapter,zip:n.obzImportAdapter,obz:n.obzImportAdapter,obf:n.obfImportAdapter},i={boards:".obf",images:"images/"},u=a.b,c=a.c;t.default={IMPORT_CONFIG_BY_EXTENSION:o,IMPORT_PATHS:i,CBOARD_EXT_PREFIX:u,CBOARD_EXT_PROPERTIES:c}},1907:function(e,t,r){"use strict";r.r(t),r.d(t,"cboardImportAdapter",(function(){return k})),r.d(t,"obzImportAdapter",(function(){return E})),r.d(t,"obfImportAdapter",(function(){return T})),r.d(t,"requestQuota",(function(){return I}));var n=r(2),a=r(3),o=r.n(a),i=r(11),u=r(1908),c=r.n(u),s=r(1898),f=r.n(s),p=r(85),d=r.n(p),l=r(1906),b=r(25);function h(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=/(_\w)/g,r=function(e){return e[1].toUpperCase()};return e.replace(t,r)}function v(e){return y.apply(this,arguments)}function y(){return(y=Object(i.a)(o.a.mark((function e(t){var r,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){var r=new FileReader;r.onload=function(t){if(2===t.target.readyState)try{e(new Blob([r.result]))}catch(n){e(null)}},r.readAsArrayBuffer(t)}));case 2:if(null!==(r=e.sent)){e.next=5;break}return e.abrupt("return",Promise.reject());case 5:return n=URL.createObjectURL(r),e.abrupt("return",new Promise((function(e){c.a.getBinaryContent(n,(function(t,r){e(t||f.a.loadAsync(r))}))})));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(e){var t={id:e.id||d.a.generate(),label:e.label||""};return e.background_color&&(t.backgroundColor=e.background_color),e.border_color&&(t.borderColor=e.border_color),e.vocalization&&(t.vocalization=e.vocalization),e.action&&(t.action=e.action),t}function x(e){return g.apply(this,arguments)}function g(){return(g=Object(i.a)(o.a.mark((function e(t){var r,n,a,u=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=u.length>1&&void 0!==u[1]?u[1]:{},n=u.length>2&&void 0!==u[2]?u[2]:{},e.next=4,Promise.all(t.buttons.map(function(){var e=Object(i.a)(o.a.mark((function e(a){var i,u,c,s,f,p,d,v;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=w(a),a.load_board&&(u=a.load_board).path&&r[u.path]&&(i.loadBoard=r[u.path].id),!a.image_id){e.next=24;break}if(c=a.image_id,!(s=t.images.find((function(e){return e.id===c})))){e.next=24;break}if(f=s.data||null,s.content_type&&s.path&&n[s.path]&&(p="image/svg"===s.content_type?"image/svg+xml":s.content_type,f="data:".concat(p,";base64,").concat(n[s.path])),s.url&&(i.image=s.url),!f){e.next=24;break}return d=f,e.prev=11,e.next=14,b.a.uploadFromDataURL(d,c,!0);case 14:v=e.sent,d=v||d,e.next=21;break;case 18:e.prev=18,e.t0=e.catch(11),console.log(e.t0.message);case 21:return e.prev=21,i.image=d,e.finish(21);case 24:return Object.keys(a).filter((function(e){return e.startsWith(l.CBOARD_EXT_PREFIX)})).forEach((function(e){var t=h(e.slice(l.CBOARD_EXT_PREFIX.length));i[t]=a[e]})),e.abrupt("return",i);case 27:case"end":return e.stop()}}),e,null,[[11,18,21,24]])})));return function(t){return e.apply(this,arguments)}}()));case 4:return a=e.sent,e.abrupt("return",a);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e){return _.apply(this,arguments)}function _(){return(_=Object(i.a)(o.a.mark((function e(t){var r,a,i,u,c,s=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=s.length>1&&void 0!==s[1]?s[1]:{},a=s.length>2&&void 0!==s[2]?s[2]:{},i=s.length>3&&void 0!==s[3]?s[3]:[],!O(i).includes(t.id)){e.next=6;break}return e.abrupt("return",void 0);case 6:if(u=[],!t.buttons){e.next=11;break}return e.next=10,x(t,r,a);case 10:u=e.sent;case 11:return c={id:t.id||d.a.generate(),tiles:u},t.grid&&(c=Object(n.a)(Object(n.a)({},c),{},{isFixed:!0,grid:t.grid})),Object.keys(t).filter((function(e){return e.startsWith(l.CBOARD_EXT_PREFIX)})).forEach((function(e){var r=h(e.slice(l.CBOARD_EXT_PREFIX.length));c[r]=t[e]})),"undefined"!==typeof t.name?c.name=t.name:c.name="unknown name",t.locale&&(c.locale=t.locale),e.abrupt("return",c);case 18:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function O(e){var t=[];return e.forEach((function(e){"undefined"!==typeof e.id&&t.push(e.id),"undefined"!==typeof e.prevId&&t.push(e.prevId)})),t}function k(e,t,r){return P.apply(this,arguments)}function P(){return(P=Object(i.a)(o.a.mark((function e(t,r,n){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=new FileReader,e.abrupt("return",new Promise((function(e,r){a.onload=function(){var t=Object(i.a)(o.a.mark((function t(i){var u,c,s;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(2===i.target.readyState)try{u=JSON.parse(a.result),c=O(n),s=u.filter((function(e){return("undefined"===typeof e.ext_cboard_hidden||!e.ext_cboard_hidden)&&"root"!==e.id&&!c.includes(e.id)})),e(s)}catch(o){r(o)}case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),a.readAsText(t)})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function E(e,t,r){return R.apply(this,arguments)}function R(){return(R=Object(i.a)(o.a.mark((function e(t,r,n){var a,u,c,s,f,p,d,b,h,y;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v(t);case 2:if("object"===typeof(a=e.sent)){e.next=5;break}throw new Error(a);case 5:return u=Object.keys(a.files),c=u.filter((function(e){return!a.files[e].dir&&e.endsWith(l.IMPORT_PATHS.boards)})),s=u.filter((function(e){return!a.files[e].dir&&e.startsWith(l.IMPORT_PATHS.images)})),f={},p={},d=O(n),e.next=13,Promise.all(u.map(function(){var e=Object(i.a)(o.a.mark((function e(t){var r,n,i,u;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((r=c.indexOf(t)>=0)||!(s.indexOf(t)<0)){e.next=3;break}return e.abrupt("return",Promise.resolve());case 3:return n=r?"text":"base64",i=null,e.prev=5,e.next=8,a.files[t].async(n);case 8:i=e.sent,r?"undefined"!==typeof(u=JSON.parse(i)).ext_cboard_hidden&&u.ext_cboard_hidden||"root"===u.id||d.includes(u.id)||(f[t]=u):t.startsWith("images//")?p[t.substring(7)]=i:p[t]=i,e.next=14;break;case 12:e.prev=12,e.t0=e.catch(5);case 14:return e.abrupt("return",i);case 15:case"end":return e.stop()}}),e,null,[[5,12]])})));return function(t){return e.apply(this,arguments)}}()));case 13:b=[],e.t0=o.a.keys(f);case 15:if((e.t1=e.t0()).done){e.next=23;break}return h=e.t1.value,e.next=19,m(f[h],f,p);case 19:y=e.sent,b.push(y),e.next=15;break;case 23:return e.abrupt("return",b);case 24:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function T(e,t,r){return A.apply(this,arguments)}function A(){return(A=Object(i.a)(o.a.mark((function e(t,r,n){var a,i,u;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=new FileReader,e.next=3,new Promise((function(e){a.onload=function(t){if(2===t.target.readyState)try{var r=JSON.parse(a.result);e(r)}catch(n){e(n)}},a.readAsText(t)}));case 3:if("object"===typeof(i=e.sent)){e.next=6;break}throw new Error(i);case 6:return e.next=8,m(i,{},{},n);case 8:if(!(u=e.sent)){e.next=11;break}return e.abrupt("return",[u]);case 11:return e.abrupt("return",[]);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function I(e){return j.apply(this,arguments)}function j(){return(j=Object(i.a)(o.a.mark((function e(t){var r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!((r=JSON.stringify(t).length)>4194304)){e.next=15;break}if(!(navigator&&navigator.webkitPersistentStorage&&navigator.webkitPersistentStorage.requestQuota)){e.next=14;break}return e.prev=4,e.next=7,new Promise((function(e,t){navigator.webkitPersistentStorage.requestQuota(2*r,(function(n){n>=r?e():t("Granted size is below the limit: ".concat(n))}),(function(e){return t("Request quota error: ".concat(e))}))}));case 7:e.next=12;break;case 9:throw e.prev=9,e.t0=e.catch(4),new Error(e.t0);case 12:e.next=15;break;case 14:throw new Error("Can't request quota");case 15:return e.abrupt("return",r);case 16:case"end":return e.stop()}}),e,null,[[4,9]])})))).apply(this,arguments)}},1908:function(e,t,r){"use strict";var n={};function a(){try{return new window.XMLHttpRequest}catch(e){}}n._getBinaryFromXHR=function(e){return e.response||e.responseText};var o="undefined"!==typeof window&&window.ActiveXObject?function(){return a()||function(){try{return new window.ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}()}:a;n.getBinaryContent=function(e,t){var r,a,i,u;t||(t={}),"function"===typeof t?(u=t,t={}):"function"===typeof t.callback&&(u=t.callback),u||"undefined"===typeof Promise?(a=function(e){u(null,e)},i=function(e){u(e,null)}):r=new Promise((function(e,t){a=e,i=t}));try{var c=o();c.open("GET",e,!0),"responseType"in c&&(c.responseType="arraybuffer"),c.overrideMimeType&&c.overrideMimeType("text/plain; charset=x-user-defined"),c.onreadystatechange=function(t){if(4===c.readyState)if(200===c.status||0===c.status)try{a(n._getBinaryFromXHR(c))}catch(r){i(new Error(r))}else i(new Error("Ajax error for "+e+" : "+this.status+" "+this.statusText))},t.progress&&(c.onprogress=function(r){t.progress({path:e,originalEvent:r,percent:r.loaded/r.total*100,loaded:r.loaded,total:r.total})}),c.send()}catch(s){i(new Error(s),null)}return r},e.exports=n}}]);
//# sourceMappingURL=2.823f7877.chunk.js.map